<!DOCTYPE html>
<html>

<head>
    <base target="_top">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/flowbite/2.3.0/flowbite.min.css" rel="stylesheet" />
    <link href="https://rawcdn.githack.com/shinxzxzxz/TableJS/c8218ba13b4d74c34af06f9f25d5063b6a99956f/tablejs.css"
        rel="stylesheet" />
    <script src="https://cdn.tailwindcss.com"></script>
    <script defer type="module"
        src="https://rawcdn.githack.com/shinxzxzxz/TableJS/55597d91c8f5165cdfaaf90798bc2e0e886a42e8/tablejs.js"></script>
    <!-- <script defer type="module"
        src="https://rawcdn.githack.com/shinxzxzxz/TableJs-v2/fa9f1e82cf2595093650626d177115e1806a3919/tablejs.js"></script> -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/flowbite/2.3.0/datepicker.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script>
        tailwind.config = {
            darkMode: ['[data-mode="dark"]']
        }
    </script>
    <?!= include('CSS'); ?>
</head>

<body>
    <nav class="fixed top-0 z-[39] w-full bg-white border-b border-gray-200">
        <div class="px-3 py-3 lg:px-5 lg:pl-3 h-14">
            <div class="flex items-center justify-between">
                <div class="flex items-center justify-start rtl:justify-end">
                    <button data-drawer-target="logo-sidebar" data-drawer-toggle="logo-sidebar"
                        aria-controls="logo-sidebar" type="button"
                        class="inline-flex items-center p-2 text-sm text-gray-500 rounded-lg sm:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200">
                        <span class="sr-only">Open sidebar</span>
                        <svg class="w-6 h-6" aria-hidden="true" fill="currentColor" viewBox="0 0 20 20"
                            xmlns="http://www.w3.org/2000/svg">
                            <path clip-rule="evenodd" fill-rule="evenodd"
                                d="M2 4.75A.75.75 0 012.75 4h14.5a.75.75 0 010 1.5H2.75A.75.75 0 012 4.75zm0 10.5a.75.75 0 01.75-.75h7.5a.75.75 0 010 1.5h-7.5a.75.75 0 01-.75-.75zM2 10a.75.75 0 01.75-.75h14.5a.75.75 0 010 1.5H2.75A.75.75 0 012 10z">
                            </path>
                        </svg>
                    </button>
                    <!-- <a href="https://flowbite.com" class="flex ms-5 md:me-24"> -->
                    <span class="pl-6 self-center text-xl font-semibold sm:text-2xl whitespace-nowrap">
                        SPPM 2
                    </span>
                    <!-- </a> -->
                </div>
            </div>
        </div>
    </nav>

    <!-- sidebar -->
    {{SIDEBAR}}

    <!-- Add Form Modal -->
    <div id="add-modal" tabindex="-1" aria-hidden="true" data-modal-backdrop="static"
        class="hidden overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] max-h-full">
        <div class="relative p-4 w-full max-w-2xl max-h-full">
            <!-- Modal content -->
            <div class="relative bg-white rounded-lg shadow">
                <!-- Modal header -->
                <div class="flex items-center justify-between p-4 md:p-5 border-b rounded-t">
                    <h3 class="text-lg font-semibold text-gray-900">
                        Add RFP Group
                    </h3>
                    <button type="button"
                        class="text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center"
                        data-modal-toggle="add-modal">
                        <svg class="w-3 h-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none"
                            viewBox="0 0 14 14">
                            <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6" />
                        </svg>
                        <span class="sr-only">Close modal</span>
                    </button>
                </div>
                <!-- Modal body -->
                <form id="add-modal-form" class="p-4 md:p-5 form-to-submit" data-action="addRFPGroup"
                    data-modal-id="add-modal">
                    <div class="grid gap-4 mb-4 grid-cols-2">
                        <div class="col-span-2">
                            <label for="networkProvider" class="block mb-2 text-sm font-medium text-gray-900">Network
                                Provider
                            </label>
                            <select id="networkProvider" name="networkProvider" required
                                class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5">
                                <option value="" disabled selected>Select Network Provider</option>
                                <option value="Smart">Smart</option>
                                <option value="Sun">Sun</option>
                                <option value="Globe">Globe</option>
                            </select>
                        </div>
                        <div class="col-span-2 sm:col-span-1">
                            <label for="company" class="block mb-2 text-sm font-medium text-gray-900">Company</label>
                            <select id="company" name="company" required
                                class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5">
                                <option value="" disabled selected>Select Company</option>
                                <option value="BDC">BDC</option>
                                <option value="WFC">WFC</option>
                            </select>
                        </div>
                        <div class="col-span-2 sm:col-span-1">
                            <label for="payableTo" class="block mb-2 text-sm font-medium text-gray-900">Payable
                                To</label>
                            <select id="payableTo" name="payableTo" required
                                class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5">
                                <option value="" disabled selected>Select Payable To</option>
                                <option value="Borland Development Corporation">Borland Development Corporation</option>
                                <option value="Globe Telecom, Inc.">Globe Telecom, Inc.</option>
                                <option value="Smart Communications Inc.">Smart Communications Inc.</option>
                            </select>
                        </div>
                    </div>
                    <div class="flex justify-end pt-2">
                        <button type="submit"
                            class="to-disable text-white inline-flex items-center bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center">
                            Submit
                        </button>
                    </div>
                </form>
                <!-- <div class="flex items-center justify-end p-4 md:p-5 border-t rounded-t">
                    <button type="submit" id="add-modal-submit"
                        class="text-white inline-flex items-center bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center">
                        Add new group
                    </button>
                </div> -->
            </div>
        </div>
    </div>

    <!-- Edit Form Modal -->
    <div id="edit-modal" tabindex="-1" aria-hidden="true" data-modal-backdrop="static"
        class="hidden overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] max-h-full">
        <div class="relative p-4 w-full max-w-2xl max-h-full">
            <!-- relative p-4 w-full max-w-2xl max-h-full -->
            <!-- Modal content -->
            <div class="relative bg-white rounded-lg shadow">
                <!-- Modal header -->
                <div class="flex items-center justify-between p-4 md:p-5 border-b rounded-t">
                    <h3 class="text-lg font-semibold text-gray-900">
                        Edit Group Info
                    </h3>
                    <button type="button"
                        class="text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center"
                        data-modal-toggle="edit-modal">
                        <svg class="w-3 h-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none"
                            viewBox="0 0 14 14">
                            <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6" />
                        </svg>
                        <span class="sr-only">Close modal</span>
                    </button>
                </div>
                <!-- Modal body -->
                <form id="edit-modal-form" class="p-4 md:p-5 form-to-submit" data-action="editRFPGroup"
                    data-modal-id="edit-modal">
                    <div class="grid gap-4 mb-4 grid-cols-2">
                        <input type="text" name="groupId" id="groupId" hidden>
                        <div class="col-span-2">
                            <label for="editGroupName" class="block mb-2 text-sm font-medium text-gray-900">
                                Group Name
                            </label>
                            <input type="text" name="editGroupName" id="editGroupName"
                                class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5"
                                placeholder="Enter Group Name" required="">
                        </div>
                        <div class="col-span-2">
                            <label for="editNetworkProvider"
                                class="block mb-2 text-sm font-medium text-gray-900">Network
                                Provider
                            </label>
                            <select id="editNetworkProvider" name="editNetworkProvider" required
                                class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5">
                                <option value="" disabled selected>Select Network Provider</option>
                                <option value="Smart">Smart</option>
                                <option value="Sun">Sun</option>
                                <option value="Globe">Globe</option>
                            </select>
                        </div>
                        <div class="col-span-2 sm:col-span-1">
                            <label for="editCompany"
                                class="block mb-2 text-sm font-medium text-gray-900">Company</label>
                            <select id="editCompany" name="editCompany" required
                                class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5">
                                <option value="" disabled selected>Select Company</option>
                                <option value="BDC">BDC</option>
                                <option value="WFC">WFC</option>
                            </select>
                        </div>
                        <div class="col-span-2 sm:col-span-1">
                            <label for="editPayableTo" class="block mb-2 text-sm font-medium text-gray-900">Payable
                                To</label>
                            <select id="editPayableTo" name="editPayableTo" required
                                class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5">
                                <option value="" disabled selected>Select Payable To</option>
                                <option value="Borland Development Corporation">Borland Development Corporation</option>
                                <option value="Globe Telecom, Inc.">Globe Telecom, Inc.</option>
                                <option value="Smart Communications Inc.">Smart Communications Inc.</option>
                            </select>
                        </div>
                    </div>
                    <div class="flex justify-end pt-2">
                        <button type="submit"
                            class="to-disable text-white inline-flex items-center bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center">
                            Save
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Delete Modal -->
    <div id="delete-modal" tabindex="-1"
        class="hidden overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] max-h-full">
        <div class="relative p-4 w-full max-w-md max-h-full">
            <div class="relative bg-white rounded-lg shadow">
                <button type="button"
                    class="absolute top-3 end-2.5 text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center"
                    data-modal-hide="delete-modal">
                    <svg class="w-3 h-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none"
                        viewBox="0 0 14 14">
                        <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6" />
                    </svg>
                    <span class="sr-only">Close modal</span>
                </button>
                <div class="p-4 md:p-5 text-center" data-modal-id="delete-modal">
                    <svg class="mx-auto mb-4 text-gray-400 w-12 h-12" xmlns="http://www.w3.org/2000/svg" fill="none"
                        viewBox="0 0 20 20">
                        <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M10 11V6m0 8h.01M19 10a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" />
                    </svg>
                    <h3 class="mb-5 text-lg font-normal text-gray-500">Are you sure you
                        want to delete this record?</h3>
                    <button type="button" id="delete-confirm-button"
                        class="text-white bg-red-600 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 dark:focus:ring-red-800 font-medium rounded-lg text-sm inline-flex items-center px-5 py-2.5 text-center">
                        Yes, I'm sure
                    </button>
                    <button data-modal-hide="delete-modal" type="button" id="cancel-delete"
                        class="py-2.5 px-5 ms-3 text-sm font-medium text-gray-900 focus:outline-none bg-white rounded-lg border border-gray-200 hover:bg-gray-100 hover:text-blue-700 focus:z-10 focus:ring-4 focus:ring-gray-100">
                        No, cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Message -->



    <div class="fixed top-14 right-0 w-vw-64 h-vh-14">
        <!-- Table Header Controller -->
        <div class="w-full h-14 flex justify-between items-center border-b border-neutral-200">
            <div class="flex space-x-2">
                <!-- search -->
                <label for="searchInput" class="sr-only">Search</label>
                <div class="relative w-full">
                    <div class="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none">
                        <svg aria-hidden="true" class="w-5 h-5 text-gray-500" viewbox="0 0 20 20"
                            xmlns="http://www.w3.org/2000/svg">
                            <path fill-rule="evenodd"
                                d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z"
                                clip-rule="evenodd" />
                        </svg>
                    </div>
                    <input type="text" id="pagination-search"
                        class="block w-full p-2 pl-10 text-sm text-gray-900 border border-gray-300 rounded bg-gray-50 focus:ring-black focus:border-black"
                        placeholder="Search" required="">
                </div>
                <!-- colvis -->
                <div class="relative w-40">
                    <button data-dropdown-toggle="table-colvis"
                        class="relative block w-40 p-1.5 border bg-neutral-50 border-neutral-300 text-neutral-900 sm:text-sm rounded focus:ring-neutral-600 focus:border-neutral-600">
                        <div
                            class="absolute inset-y-0 start-0 flex items-center ps-3 pointer-events-none text-neutral-500">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                                stroke="currentColor" class="w-5 h-5">
                                <path stroke-linecap="round" stroke-linejoin="round"
                                    d="M10.5 6h9.75M10.5 6a1.5 1.5 0 1 1-3 0m3 0a1.5 1.5 0 1 0-3 0M3.75 6H7.5m3 12h9.75m-9.75 0a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m-3.75 0H7.5m9-6h3.75m-3.75 0a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m-9.75 0h9.75" />
                            </svg>
                        </div>
                        Columns
                    </button>
                    <div data-popover id="table-colvis"
                        class="text-left z-50 hidden bg-white divide-y divide-neutral-100 rounded-lg shadow w-44 max-h-vh-36 overflow-x-auto">
                        <ul class="py-2 text-sm text-neutral-700"></ul>
                    </div>
                </div>
            </div>
            <div>
                <!-- Add Form Modal toggle -->
                <div
                    class="flex flex-col items-stretch justify-end flex-shrink-0 w-full space-y-2 md:w-auto md:flex-row md:space-y-0 md:items-center md:space-x-3">
                    <button data-modal-target="add-modal" data-modal-toggle="add-modal" type="button"
                        id="add-modal-toggle"
                        class="flex items-center justify-center px-4 py-2 text-sm font-medium text-white rounded-lg bg-blue-700 hover:bg-primary-800 focus:ring-4 focus:ring-primary-300 disable-on-load">
                        Add Group
                    </button>
                    <button type="button" id="export-csv"
                        class="flex items-center justify-center px-4 py-2 text-sm font-medium text-white rounded-lg bg-green-700 hover:bg-green-800 focus:ring-4 focus:ring-green-300 disable-on-load">
                        Export CSV
                    </button>
                    <div class="flex items-center w-full space-x-3 md:w-auto">
                    </div>
                    <!-- <div class="flex items-center w-full space-x-3 md:w-auto">
                    </div> -->
                </div>
            </div>
        </div>

        <!-- Main content -->
        <div class="h-vh-40 overflow-y-auto overflow-x-auto">
            <!-- Spinner -->
            <div class="flex items-center justify-center h-vh-40" id="spinner">
                <div role="status" class="flex items-center space-x-2">
                    <!-- <svg aria-hidden="true" class="w-8 h-8 mr-2 text-gray-200 animate-spin fill-blue-600" viewBox="0 0 100 101"
                        fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path
                            d="M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9765 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9765 100 50.5908ZM9.0814 50.5908C9.0814 73.1274 27.4634 91.5095 50 91.5095C72.5366 91.5095 90.9186 73.1274 90.9186 50.5908C90.9186 28.0541 72.5366 9.67205 50 9.67205C27.4634 9.67205 9.0814 28.0541 9.0814 50.5908Z"
                            fill="currentColor" />
                        <path
                            d="M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5535C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.5417 14.6176 79.7447 9.8825 73.1236 6.65441C68.0628 4.34571 62.3643 2.84064 56.4643 2.19645C51.7573 1.68491 46.9703 1.78246 42.3061 2.48526C39.8403 2.89009 38.3457 5.38335 38.9829 7.80871C39.6201 10.2341 42.0912 11.7064 44.5738 11.2885C48.616 10.6376 52.744 10.6695 56.7385 11.3697C61.7997 12.2598 66.627 14.0504 70.9047 16.6236C76.2316 19.6655 80.635 23.8834 83.8745 28.972C86.1371 32.5418 87.804 36.4437 88.8143 40.4992C89.3192 42.5188 91.5425 43.678 93.9676 43.0409Z"
                            fill="currentFill" />
                    </svg> -->
                    <svg aria-hidden="true" class="w-8 h-8 mr-2 text-gray-200 animate-spin fill-gray-600"
                        xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"
                        fill="none"><!--!Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.-->
                        <path
                            d="M304 48a48 48 0 1 0 -96 0 48 48 0 1 0 96 0zm0 416a48 48 0 1 0 -96 0 48 48 0 1 0 96 0zM48 304a48 48 0 1 0 0-96 48 48 0 1 0 0 96zm464-48a48 48 0 1 0 -96 0 48 48 0 1 0 96 0zM142.9 437A48 48 0 1 0 75 369.1 48 48 0 1 0 142.9 437zm0-294.2A48 48 0 1 0 75 75a48 48 0 1 0 67.9 67.9zM369.1 437A48 48 0 1 0 437 369.1 48 48 0 1 0 369.1 437z" />
                    </svg>
                    <!-- <span class="sr-only">Loading...</span> -->
                </div>
            </div>
            <div id="tableContainer" class="table-container hidden">
                <table id="tablejs" class="w-full text-sm text-left rtl:text-right text-gray-500">
                    <thead class="text-xs text-gray-700 uppercase bg-gray-50">
                        <tr>
                            <th scope="col" class="px-6 py-3">
                                GROUP ID
                            </th>
                            <th scope="col" class="px-6 py-3">
                                GROUP NAME
                            </th>
                            <th scope="col" class="px-6 py-3">
                                COMPANY
                            </th>
                            <th scope="col" class="px-6 py-3">
                                NETWORK PROVIDER
                            </th>
                            <th scope="col" class="px-6 py-3">
                                PAYABLE TO
                            </th>
                            <th scope="col" class="px-6 py-3">
                                ACTION
                            </th>
                        </tr>
                    </thead>
                    <tbody id="tableBody">
                        <tr>
                            <td scope="col" class="px-6 py-3">No data</td>
                            <td scope="col" class="px-6 py-3">No data</td>
                            <td scope="col" class="px-6 py-3">No data</td>
                            <td scope="col" class="px-6 py-3">No data</td>
                            <td scope="col" class="px-6 py-3">No data</td>
                            <td scope="col" class="px-6 py-3">Action</td>
                        </tr>

                    </tbody>
                </table>
            </div>
        </div>

        <!-- Table Footer Controller -->
        <div class="flex items-center justify-between border-t border-neutral-200 px-4 h-12">
            <!-- <div class="info flex items-center space-x-2">
                <div class="font-bold text-xl me-8 w-24">
                    TOTAL
                </div>
                <div class="font-medium text-xl me-2" id="reports-total">
                    0.00
                </div>
            </div> -->
            <div class="text-sm">
                <span class="text-sm" id="pagination-records">Shows 1 of 1 of 1 entries</span>
            </div>
            <div class="flex items-center space-x-2">
                <div class="text-sm">
                    Rows per page
                </div>
                <div class="text-sm">
                    <select id="pagination-limit"
                        class="block w-full items-center justify-center px-2 h-8 text-xs font-medium text-neutral-500 bg-white border rounded-lg hover:bg-neutral-100 hover:text-neutral-700  border-neutral-300 focus-within:ring-0 focus:ring-neutral-500 focus:outline-none focus:border-neutral-500">
                        <option value="*" selected>All</option>
                        <option value="10">10</option>
                        <option value="25">25</option>
                        <option value="50">50</option>
                        <option value="100">100</option>
                        <option value="500">500</option>
                        <option value="1000">1000</option>
                    </select>
                </div>
                <span class="text-sm" id="pagination-label">Page 1 of 10</span>
                <button id="pagination-previous"
                    class="aspect-square flex items-center justify-center px-2 h-8 text-sm font-medium text-neutral-500 bg-white border border-neutral-300 rounded-lg hover:bg-neutral-100 hover:text-neutral-700"
                    name="previous">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                        stroke="currentColor" class="w-6 h-6">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5" />
                    </svg>
                </button>
                <button id="pagination-next"
                    class="aspect-square flex items-center justify-center px-2 h-8 text-sm font-medium text-neutral-500 bg-white border border-neutral-300 rounded-lg hover:bg-neutral-100 hover:text-neutral-700 "
                    name="next">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                        stroke="currentColor" class="w-6 h-6">
                        <path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5" />
                    </svg>
                </button>
            </div>
        </div>
    </div>

    <button id="export-csv" class="hidden">Export CSV</button>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/flowbite/2.3.0/flowbite.min.js"></script>
    <?!= include('JavaScript'); ?>
    <script>
        document.addEventListener('DOMContentLoaded', async function () {

            const ids = generateIds(document.querySelectorAll('[id]'));

            const spinner = document.getElementById('spinner');
            const tableContainer = document.getElementById('tableContainer');

            const onClickEvents = {
                viewData: function (data) {
                    console.warn(data);
                    console.warn(Object.keys(data));
                    loadViewFields(data);
                    showModal('view');
                },
                editData: function (data) {
                    loadEditFields(data);
                    showModal('edit');
                },
                deleteData: function (data) {
                    Swal.fire({
                        title: "Are you sure you want to delete this record?",
                        showCancelButton: true,
                        icon: 'info',
                        confirmButtonText: "Yes, I'm sure",
                        cancelButtonText: "No, cancel",
                        customClass: {
                            title: 'mb-5 text-lg font-normal text-gray-500',
                            cancelButton: 'cursor-pointer text-white bg-gray-600 hover:bg-gray-800 focus:ring-4 focus:outline-none focus:ring-gray-300 font-medium rounded-lg text-sm inline-flex items-center px-5 py-2.5 text-center',
                            confirmButton: 'cursor-pointer text-white bg-red-600 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm inline-flex items-center px-5 py-2.5 text-center',

                        }
                    }).then((result) => {
                        /* Read more about isConfirmed, isDenied below */
                        if (result.isConfirmed) {
                            // Swal.fire("Deleted!", "", "success");
                            console.log("CHECK", data.RFP_GROUP_ID);
                            handleDelete(data.RFP_GROUP_ID);
                        } else if (result.isDenied) {
                            // Swal.fire("Changes are not saved", "", "info");
                        }
                    });
                }
            }

            // document.querySelectorAll('button').forEach(button => {
            //     button.classList.add('cursor-not-allowed');
            //     button.disabled = true;
            // });

            // Targeting a specific class instead of all the buttons
            document.querySelectorAll('.disable-on-load').forEach(button => {
                button.classList.add('cursor-not-allowed');
                button.disabled = true;
            });

            // const totalElement = document.querySelector('div#reports-total');
            const recordElement = document.querySelector('span#pagination-records');
            const pagingElement = document.querySelector('span#pagination-label');

            const output = {
                pagination: ({
                    current_page,
                    total_page,
                    start_item,
                    end_item,
                    total_rows,
                }) => {
                    if (recordElement)
                        recordElement.innerHTML = `Shows ${start_item} to ${end_item} of ${total_rows} entries`;
                    if (pagingElement)
                        pagingElement.innerHTML = `Page ${current_page} of ${total_page}`;
                },
            };
            // Make this part dynamic
            const headers = [
                'RFP_GROUP_ID',
                'RFP_GROUP_NAME',
                'RFP_COMPANY',
                'NETWORK_PROVIDER',
                'PAYABLE_TO'
            ];

            async function renderTable({ data, table }) {
                const thead = table.querySelector('thead');
                const tbody = table.querySelector('tbody');

                // Clear existing content
                thead.innerHTML = '';
                tbody.innerHTML = '';

                // Create Header
                const headerRow = document.createElement('tr');
                headers.forEach((header) => {
                    const th = document.createElement('th');
                    th.scope = 'col';
                    th.classList.add('px-6', 'py-3');
                    th.textContent = header.replace(/[_\s]{1,}/g, ' ');
                    headerRow.appendChild(th);
                });
                // Add Action Header
                const actionHeader = document.createElement('th');
                actionHeader.scope = 'col';
                actionHeader.classList.add('px-6', 'py-3', 'actions-column');
                actionHeader.textContent = 'Actions';
                headerRow.appendChild(actionHeader);
                thead.appendChild(headerRow);

                // Create Body
                data.forEach((row, index) => {

                    const tr = document.createElement('tr');
                    tr.classList.add('bg-white', 'border-b');
                    if (tr.index === undefined || tr.index === null) {
                        tr.index = index;
                        tr.dataset.index = index;
                    }

                    // Add Action Buttons
                    const actionTd = document.createElement('td');
                    actionTd.classList.add('px-6', 'py-3');
                    const actionDiv = document.createElement('div');
                    actionDiv.classList.add('action-buttons', 'flex', 'space-x-2');

                    if (Object.entries(row).every(([key, value]) => value === "")) {
                        const NoData = "No data";
                        headers.forEach((header) => {
                            const td = document.createElement('td');
                            td.classList.add('px-6', 'py-3');
                            td.textContent = NoData;
                            tr.appendChild(td);
                        });
                        actionTd.textContent = "Actions";
                    } else {
                        headers.forEach((header) => {
                            const td = document.createElement('td');
                            let value = row[header];
                            // if(header == 'COMPANY') {
                            //     value = company;
                            // }
                            td.classList.add('px-6', 'py-3');
                            const numberValues = [];
                            switch (true) {
                                case numberValues.includes(header):
                                    td.textContent = Number(value).toFixed(2);
                                    td.classList.add('text-right');
                                    break;
                                default:
                                    td.textContent = value;
                                    break;
                            }
                            tr.appendChild(td);
                        });

                        const editButton = generateActionButton(vectors.edit, {
                            class: 'px-2 py-2 bg-blue-500 text-white rounded',
                            onClick: () => onClickEvents.editData({
                                ...row
                            })
                        }, row);
                        const deleteButton = generateActionButton(vectors.delete, {
                            class: 'px-2 py-2 bg-red-500 text-white rounded',
                            onClick: () => onClickEvents.deleteData({
                                ...row,
                            })
                        }, row);
                        console.log(row);
                        actionDiv.appendChild(editButton);
                        actionDiv.appendChild(deleteButton);
                        actionTd.appendChild(actionDiv);
                    }

                    tr.appendChild(actionTd);
                    tbody.appendChild(tr);
                });
            }

            console.log(TableJS);
            const table = document.getElementById('tablejs');
            const instance = new TableJS(table, {
                dataset: {
                    init: false,
                    collection: [],
                    rendering: renderTable
                },
                colvis: {
                    element: 'div#table-colvis',
                    exclude: ['.checkbox-column', '.actions-column'],
                    hide: [],
                },
                exportAs: [
                    {
                        as: 'csv',
                        element: 'button#export-csv',
                        filename: 'rfp-group',
                        exclude: ['.checkbox-column', '.actions-column'],
                    },
                ],
                paginate: [
                    {
                        to: 'api',
                        as: 'limit',
                        element: 'select#pagination-limit',
                        output: output.pagination,
                    },
                    {
                        to: 'api',
                        as: 'next',
                        element: 'button#pagination-next',
                        output: output.pagination,
                    },
                    {
                        to: 'api',
                        as: 'previous',
                        element: 'button#pagination-previous',
                        output: output.pagination,
                    },
                    {
                        to: 'local',
                        as: 'search',
                        element: 'input#pagination-search',
                        exclude: ['.checkbox-column', '.actions-column'],
                        output: output.pagination,
                    },
                ],
            });

            async function refreshTable() {
                const dataset = await $.getDataFromSheet(sheetName, []);

                const array = Array.from(dataset);
                console.warn(array);
                instance.setDataset(array).render();
                spinner.classList.add('hidden');
                tableContainer.classList.remove('hidden');

                // Remove the disable attribute from the buttons when the  
                document.querySelectorAll('.disable-on-load').forEach(button => {
                    button.disabled = false;
                    button.classList.remove('cursor-not-allowed');
                });
            }

            // Function to disable and enable buttons
            function toggleButtonState(buttons, state) {
                buttons.forEach(function (button) {
                    button.disabled = state;
                    button.classList.toggle('cursor-not-allowed', state);
                });
            }

            // Function to handle form submission
            function handleFormSubmission(form, modalId) {
                form.addEventListener('submit', async function (event) {
                    event.preventDefault();
                    const formData = getInputFields(form);
                    const buttons = form.querySelectorAll('button.to-disable');
                    toggleButtonState(buttons, true);

                    const action = form.dataset.action;
                    const { submitCallback, additionalOperations } = getFormConfig(action);

                    try {
                        await submitCallback(formData);
                        if (additionalOperations) {
                            await additionalOperations(formData);
                        }
                        refreshTable();
                        // showToast("Record successfully processed", "success");
                        toast.success({
                            title: "Record successfully processed",
                            description: "Record successfully processed",
                            timeout: 4000,
                            closeButton: false,
                        })
                        clearForm(form);
                        toggleModal(modalId); // Use the dynamic modal ID
                    } catch (error) {
                        console.error("Error:", error);
                        // showToast("An error occurred. Please try again.", "error");
                        toast.error({
                            title: "An error occurred. Please try again",
                            description: "An error occurred. Please try again.",
                            timeout: 4000,
                            closeButton: false,
                        })
                    } finally {
                        setTimeout(() => toggleButtonState(buttons, false), 2000);
                    }
                });
            }

            // Function to get form configuration based on the action
            function getFormConfig(action) {
                switch (action) {
                    case 'addRFPGroup':
                        return {
                            submitCallback: formData => new Promise((resolve, reject) => {
                                google.script.run.withSuccessHandler(resolve).withFailureHandler(reject).addRFPGroup(formData);
                            }),
                            additionalOperations: formData => {
                                // Define additional operations for addForm here
                                console.log("Performing additional operations for addForm");
                                // Return a promise if the additional operations are asynchronous
                                return Promise.resolve();
                            }
                        };
                    case 'editRFPGroup':
                        return {
                            submitCallback: formData => new Promise((resolve, reject) => {
                                console.log(formData)
                                google.script.run.withSuccessHandler(resolve).withFailureHandler(reject).editRFPGroup(formData);
                            }),
                            additionalOperations: null // No additional operations for editForm
                        };
                    // Add more cases for other actions as needed
                    default:
                        throw new Error('Unknown action: ' + action);
                }
            }

            // Initialize all forms
            document.querySelectorAll('.form-to-submit').forEach(form => {
                // Get modal ID from data attribute if present
                const modalId = form.dataset.modalId;
                handleFormSubmission(form, modalId);
            });

            function toggleModal(modalId) {
                const modalToggle = document.querySelector(`[data-modal-toggle="${modalId}"]`);
                if (modalToggle) {
                    modalToggle.click();
                } else {
                    console.error(`Modal with identifier "${modalId}" not found.`);
                }
            }

            // Function to load data into edit fields
            function loadEditFields(item) {
                console.warn(item.PAYABLE_TO)
                ids.groupId.value = item.RFP_GROUP_ID;
                ids.editGroupName.value = item.RFP_GROUP_NAME;
                ids.editCompany.value = item.RFP_COMPANY;
                ids.editNetworkProvider.value = item.NETWORK_PROVIDER;
                ids.editPayableTo.value = item.PAYABLE_TO;
            }
            // Function to handle the deletion logic
            async function handleDelete(dataId, options = {}) {
                if (dataId != null) {

                    const result = await $.deleteRFPGroup(dataId);

                    if (result.status === 'Success') {
                        console.info(result);
                        await refreshTable();
                        // showToast("Item deleted successfully!", "success");
                        toast.success({
                            title: "Item deleted successfully",
                            description: "Item deleted successfully",
                            timeout: 4000,
                            closeButton: false,
                        })
                        return true;
                    } else {
                        console.error(result);
                        // showToast("Item deletion unsuccessfully!", "error");
                        toast.error({
                            title: "Item deletion unsuccessfully",
                            description: "Item deletion unsuccessfully",
                            timeout: 4000,
                            closeButton: false,
                        })
                        return false;
                    }
                }
            }

            // Make this part dynamic
            var sheetName = "RFP_GROUP";
            // Using the getData function

            refreshTable();

        });

        document.getElementById('billsAndPayment').classList.remove('hidden');

    </script>
</body>

</html>